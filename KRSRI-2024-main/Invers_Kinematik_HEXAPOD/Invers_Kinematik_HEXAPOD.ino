#include <Dynamixel2Arduino.h>
HardwareSerial Serial2(USART2);
#include <Servo.h>
#define DXL_SERIAL   Serial2
//#define DEBUG_SERIAL Serial2
const uint8_t DXL_DIR_PIN = PA4;
#define CW_ANGLE_LIMIT_ADDR         6
#define CCW_ANGLE_LIMIT_ADDR        8
#define ANGLE_LIMIT_ADDR_LEN        2
#define OPERATING_MODE_ADDR_LEN     2
#define TORQUE_ENABLE_ADDR          24
#define TORQUE_ENABLE_ADDR_LEN      1
#define LED_ADDR                    25
#define LED_ADDR_LEN                1
#define GOAL_POSITION_ADDR          30
#define GOAL_POSITION_ADDR_LEN      2
#define PRESENT_POSITION_ADDR       36
#define PRESENT_POSITION_ADDR_LEN   2
#define TIMEOUT 10    //default communication timeout 10ms
Servo capit, pegangan;
const float DXL_PROTOCOL_VERSION = 1.0;
Dynamixel2Arduino dxl(DXL_SERIAL, DXL_DIR_PIN);
int move_counter = 0;
float cx = 22;
int fm = 58;
int tb = 80;
int height = -90;
float z;
float sdtcoxa, sdtcoxa1, sdtcoxa2, sdtcoxa3, sdtcoxa4, sdtrotate, sdtfemur, sdttibia, theta2, theta3, angle1, angle2, P, c, alas, alpha, beta;
int tpr = 40;
int legoffset[6] = {0, 45, 135, 180, 225, 315};
void setup() {
  Serial.setTx(PA9);
  Serial.setRx(PA10);
  Serial.setTx(PA9);
  Serial.setRx(PA10);
  Serial2.setTx(PA2);
  Serial2.setRx(PA3);
  dxl.begin(1000000);
  dxl.setPortProtocolVersion(DXL_PROTOCOL_VERSION);
  delay(2000);
  standby();
}

void loop() {

}

void standby() {
  //  FR(-72.5, 72.5, 0.00);
  //  LM(104.5, 0.00, 0.00);
  //  BR(-72.5, -72.5, 0.00);
  FL(60, 60, 0.00);
  //  RM(-104.5, 0.00, 0.00);
  //  BL(72.5, -72.5, 0.00);
}

void angkat1kaki() {
  FR(-72.00, 72.00, 30.00);
  LM(105.00, 0.00, 30.00);
  BR(-72.00, -72.00, 30.00);
  FL(72.00, 72.00, 0.00);
  RM(-105.00, 0.00, 0.00);
  BL(72.00, -72.00, 0.00);
}

void cobamaju() {
  FR(-72.00, 42.00, 0.00);
  LM(105.00, -30.00, 0.00);
  BR(-72.00, -102.00, 0.00);
  FL(72.00, 102.00, 0.00);
  RM(-105.00, 30.00, 0.00);
  BL(72.00, -42.00, 0.00);
  delay(tpr);

  FR(-72.00, 44.58, 8.75);
  LM(105.00, -27.42, 8.75);
  BR(-72.00, -99.42, 8.75);
  FL(72.00, 99.42, 0.00);
  RM(-105.00, 27.42, 0.00);
  BL(72.00, -44.58, 0.00);
  delay(tpr);


  FR(-72.00, 51.38, 15.00);
  LM(105.00, -20.63, 15.00);
  BR(-72.00, -92.63, 15.00);
  FL(72.00, 92.63, 0.00);
  RM(-105.00, 20.63, 0.00);
  BL(72.00, -51.38, 0.00);
  delay(tpr);


  FR(-72.00, 60.98, 18.75);
  LM(105.00, -11.02, 18.75);
  BR(-72.00, -83.02, 18.75);
  FL(72.00, 83.02, 0.00);
  RM(-105.00, 11.02, 0.00);
  BL(72.00, -60.98, 0.00);
  delay(tpr);


  FR(-72.00, 72.00, 20.00);
  LM(105.00, 0.00, 20.00);
  BR(-72.00, -72.00, 20.00);
  FL(72.00, 72.00, 0.00);
  RM(-105.00, 0.00, 0.00);
  BL(72.00, -72.00, 0.00);
  delay(tpr);


  FR(-72.00, 83.02, 18.75);
  LM(105.00, 11.02, 18.75);
  BR(-72.00, -60.98, 18.75);
  FL(72.00, 60.98, 0.00);
  RM(-105.00, -11.02, 0.00);
  BL(72.00, -83.02, 0.00);
  delay(tpr);


  FR(-72.00, 92.63, 15.00);
  LM(105.00, 20.63, 15.00);
  BR(-72.00, -51.38, 15.00);
  FL(72.00, 51.38, 0.00);
  RM(-105.00, -20.63, 0.00);
  BL(72.00, -92.63, 0.00);
  delay(tpr);


  FR(-72.00, 99.42, 8.75);
  LM(105.00, 27.42, 8.75);
  BR(-72.00, -44.58, 8.75);
  FL(72.00, 44.58, 0.00);
  RM(-105.00, -27.42, 0.00);
  BL(72.00, -99.42, 0.00);
  delay(tpr);


  FR(-72.00, 102.00, 0.00);
  LM(105.00, 30.00, 0.00);
  BR(-72.00, -42.00, 0.00);
  FL(72.00, 42.00, 0.00);
  RM(-105.00, -30.00, 0.00);
  BL(72.00, -102.00, 0.00);
  delay(tpr);

  FR(-72.00, 99.42, 0.00);
  LM(105.00, 27.42, 0.00);
  BR(-72.00, -44.58, 0.00);
  FL(72.00, 44.58, 8.75);
  RM(-105.00, -27.42, 8.75);
  BL(72.00, -99.42, 8.75);
  delay(tpr);


  FR(-72.00, 92.63, 0.00);
  LM(105.00, 20.63, 0.00);
  BR(-72.00, -51.38, 0.00);
  FL(72.00, 51.38, 15.00);
  RM(-105.00, -20.63, 15.00);
  BL(72.00, -92.63, 15.00);
  delay(tpr);


  FR(-72.00, 83.02, 0.00);
  LM(105.00, 11.02, 0.00);
  BR(-72.00, -60.98, 0.00);
  FL(72.00, 60.98, 18.75);
  RM(-105.00, -11.02, 18.75);
  BL(72.00, -83.02, 18.75);
  delay(tpr);


  FR(-72.00, 72.00, 0.00);
  LM(105.00, 0.00, 0.00);
  BR(-72.00, -72.00, 0.00);
  FL(72.00, 72.00, 20.00);
  RM(-105.00, 0.00, 20.00);
  BL(72.00, -72.00, 20.00);
  delay(tpr);


  FR(-72.00, 60.98, 0.00);
  LM(105.00, -11.02, 0.00);
  BR(-72.00, -83.02, 0.00);
  FL(72.00, 83.02, 18.75);
  RM(-105.00, 11.02, 18.75);
  BL(72.00, -60.98, 18.75);
  delay(tpr);


  FR(-72.00, 51.38, 0.00);
  LM(105.00, -20.63, 0.00);
  BR(-72.00, -92.63, 0.00);
  FL(72.00, 92.63, 15.00);
  RM(-105.00, 20.63, 15.00);
  BL(72.00, -51.38, 15.00);
  delay(tpr);


  FR(-72.00, 44.58, 0.00);
  LM(105.00, -27.42, 0.00);
  BR(-72.00, -99.42, 0.00);
  FL(72.00, 99.42, 8.75);
  RM(-105.00, 27.42, 8.75);
  BL(72.00, -44.58, 8.75);
  delay(tpr);
}

void bodymaju() {
  FR(-72.00, 72.00, 0.00);
  LM(105.00, 0.00, 0.00);
  BR(-72.00, -72.00, 0.00);
  FL(72.00, 72.00, 0.00);
  RM(-105.00, 0.00, 0.00);
  BL(72.00, -72.00, 0.00);
  delay(tpr);


  FR(-72.00, 70.71, 0.00);
  LM(105.00, -1.29, 0.00);
  BR(-72.00, -73.29, 0.00);
  FL(72.00, 70.71, 0.00);
  RM(-105.00, -1.29, 0.00);
  BL(72.00, -73.29, 0.00);
  delay(tpr);


  FR(-72.00, 67.31, 0.00);
  LM(105.00, -4.69, 0.00);
  BR(-72.00, -76.69, 0.00);
  FL(72.00, 67.31, 0.00);
  RM(-105.00, -4.69, 0.00);
  BL(72.00, -76.69, 0.00);
  delay(tpr);


  FR(-72.00, 62.51, 0.00);
  LM(105.00, -9.49, 0.00);
  BR(-72.00, -81.49, 0.00);
  FL(72.00, 62.51, 0.00);
  RM(-105.00, -9.49, 0.00);
  BL(72.00, -81.49, 0.00);
  delay(tpr);


  FR(-72.00, 57.00, 0.00);
  LM(105.00, -15.00, 0.00);
  BR(-72.00, -87.00, 0.00);
  FL(72.00, 57.00, 0.00);
  RM(-105.00, -15.00, 0.00);
  BL(72.00, -87.00, 0.00);
  delay(tpr);


  FR(-72.00, 51.49, 0.00);
  LM(105.00, -20.51, 0.00);
  BR(-72.00, -92.51, 0.00);
  FL(72.00, 51.49, 0.00);
  RM(-105.00, -20.51, 0.00);
  BL(72.00, -92.51, 0.00);
  delay(tpr);


  FR(-72.00, 46.69, 0.00);
  LM(105.00, -25.31, 0.00);
  BR(-72.00, -97.31, 0.00);
  FL(72.00, 46.69, 0.00);
  RM(-105.00, -25.31, 0.00);
  BL(72.00, -97.31, 0.00);
  delay(tpr);


  FR(-72.00, 43.29, 0.00);
  LM(105.00, -28.71, 0.00);
  BR(-72.00, -100.71, 0.00);
  FL(72.00, 43.29, 0.00);
  RM(-105.00, -28.71, 0.00);
  BL(72.00, -100.71, 0.00);
  delay(tpr);


  FR(-72.00, 42.00, 0.00);
  LM(105.00, -30.00, 0.00);
  BR(-72.00, -102.00, 0.00);
  FL(72.00, 42.00, 0.00);
  RM(-105.00, -30.00, 0.00);
  BL(72.00, -102.00, 0.00);
  delay(tpr);
}
